<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "Smash Seeding Chile" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <link rel="manifest" href="/manifest.json">
    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">
    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
    
    <script type="text/javascript">
      // Función para mostrar/ocultar eventos de un torneo
      window.toggleEvents = function(tournamentId) {
        const eventRows = document.querySelectorAll(`.event-row[data-tournament-id="${tournamentId}"]`);
        
        eventRows.forEach(row => {
          if (row.classList.contains('hidden')) {
            row.classList.remove('hidden');
          } else {
            row.classList.add('hidden');
            
            // También ocultar las filas de seeds asociadas a este torneo cuando se colapsan los eventos
            const seedRows = document.querySelectorAll(`.seeds-row[data-tournament-id="${tournamentId}"]`);
            seedRows.forEach(seedRow => {
              seedRow.classList.add('hidden');
              
              // Actualizar el estado de los botones de toggle
              const eventId = seedRow.getAttribute('data-event-id');
              const button = document.getElementById(`toggleSeedsButton-${eventId}`);
              if (button) {
                button.textContent = 'Ver Seeds';
                button.setAttribute('data-showing', 'false');
              }
            });
          }
        });
      };
      
      // Función para mostrar/ocultar seeds de un evento
      window.toggleSeeds = function(tournamentId, eventId) {
        const seedsRow = document.getElementById(`seedsRow-${tournamentId}-${eventId}`);
        const button = document.getElementById(`toggleSeedsButton-${eventId}`);
        
        if (seedsRow.classList.contains('hidden')) {
          seedsRow.classList.remove('hidden');
          button.textContent = 'Ocultar Seeds';
          button.setAttribute('data-showing', 'true');
        } else {
          seedsRow.classList.add('hidden');
          button.textContent = 'Ver Seeds';
          button.setAttribute('data-showing', 'false');
        }
      };
    </script>
  </head>

  <body>
    <%= turbo_frame_tag "flash" do %>
      <%= render "shared/flash" %>
    <% end %>

    <main class="container mx-auto mt-28 px-5 flex">
      <%= yield %>
    </main>
  </body>
</html>

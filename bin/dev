#!/usr/bin/env sh

# Script de desarrollo para Smash Seeding Chile
# Ejecuta todos los servicios necesarios para desarrollo usando foreman

if ! gem list foreman -i --silent; then
  echo "🔧 Instalando foreman..."
  gem install foreman
fi

echo "🚀 Iniciando servicios de desarrollo..."
echo "   - Rails server (puerto 3000)"
echo "   - Tailwind CSS watcher"
echo "   - Solid Queue (jobs en segundo plano)"
echo ""
echo "📝 Para detener todos los servicios: Ctrl+C"
echo "🌐 Aplicación: http://localhost:3000"
echo "📧 Emails: se abren automáticamente en el navegador"
echo "💼 Jobs: http://localhost:3000/jobs"
echo ""

# Default to port 3000 if not specified
export PORT="${PORT:-3000}"

# Let the debug gem allow remote connections,
# but avoid loading until `debugger` is called
export RUBY_DEBUG_OPEN="true"
export RUBY_DEBUG_LAZY="true"

exec foreman start -f Procfile.dev "$@"
